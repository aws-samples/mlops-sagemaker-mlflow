{"metadata": {"version": 1, "disable_limits": false, "instance_type": "ml.m5.4xlarge", "disable_validation": true}, "parameters": [], "nodes": [{"node_id": "91cc71d2-3b93-4631-9da6-7ab98dccae00", "type": "SOURCE", "operator": "sagemaker.s3_source_0.1", "parameters": {"dataset_definition": {"datasetSourceType": "Local File Upload", "name": "player-churn.csv", "description": null, "s3ExecutionContext": {"s3Uri": "s3://sagemaker-us-east-1-434410636156/Canvas/studio-user-1991c0e0/uploads/player-churn.csv", "s3ContentType": "csv", "s3HasHeader": true, "s3FieldDelimiter": ",", "s3DirIncludesNested": false, "s3AddsFilenameColumn": false, "s3RoleArn": null, "s3CsvEncodingType": "UTF_8", "s3SkipLines": 0, "s3MultiLine": false, "s3DataType": "S3Prefix", "s3ManifestPlain": {"s3Uris": null}}, "canvasDatasetMetadata": null}}, "inputs": [], "outputs": [{"name": "default", "sampling": {"sampling_method": "sample_by_count", "sample_size": 50000}}]}, {"node_id": "814cac1e-1370-414d-9f6e-879410954a0c", "type": "TRANSFORM", "operator": "sagemaker.spark.infer_and_cast_type_0.1", "parameters": {}, "trained_parameters": {"schema": {"player_id": "string", "cohort_id": "string", "cohort_day_of_week": "long", "player_type": "string", "player_lifetime": "float", "session_count": "long", "player_churn": "bool", "begin_session_count_last_day-1": "long", "end_session_count_last_day-1": "long", "begin_session_count_last_day-2": "long", "end_session_count_last_day-2": "long", "begin_session_count_last_day-3": "long", "end_session_count_last_day-3": "long", "begin_session_count_last_day-4": "long", "end_session_count_last_day-4": "long", "begin_session_count_last_day-5": "long", "end_session_count_last_day-5": "long", "begin_session_count_last_day-6": "long", "end_session_count_last_day-6": "long", "begin_session_count_last_day-7": "long", "end_session_count_last_day-7": "long", "begin_session_count_last_week-1": "long", "end_session_count_last_week-1": "long", "begin_session_count_last_week-2": "long", "end_session_count_last_week-2": "long", "begin_session_count_last_week-3": "long", "end_session_count_last_week-3": "long", "begin_session_count_last_month-1": "long", "end_session_count_last_month-1": "long", "begin_session_count_last_month-2": "long", "end_session_count_last_month-2": "long", "begin_session_time_of_day_mean_last_day-1": "float", "end_session_time_of_day_mean_last_day-1": "float", "begin_session_time_of_day_mean_last_day-2": "float", "end_session_time_of_day_mean_last_day-2": "float", "begin_session_time_of_day_mean_last_day-3": "float", "end_session_time_of_day_mean_last_day-3": "float", "begin_session_time_of_day_mean_last_day-4": "float", "end_session_time_of_day_mean_last_day-4": "float", "begin_session_time_of_day_mean_last_day-5": "float", "end_session_time_of_day_mean_last_day-5": "float", "begin_session_time_of_day_mean_last_day-6": "float", "end_session_time_of_day_mean_last_day-6": "float", "begin_session_time_of_day_mean_last_day-7": "float", "end_session_time_of_day_mean_last_day-7": "float", "begin_session_time_of_day_mean_last_week-1": "float", "end_session_time_of_day_mean_last_week-1": "float", "begin_session_time_of_day_mean_last_week-2": "float", "end_session_time_of_day_mean_last_week-2": "float", "begin_session_time_of_day_mean_last_week-3": "long", "end_session_time_of_day_mean_last_week-3": "long", "begin_session_time_of_day_mean_last_month-1": "float", "end_session_time_of_day_mean_last_month-1": "float", "begin_session_time_of_day_mean_last_month-2": "long", "end_session_time_of_day_mean_last_month-2": "long", "begin_session_time_of_day_std_last_day-1": "float", "end_session_time_of_day_std_last_day-1": "float", "begin_session_time_of_day_std_last_day-2": "float", "end_session_time_of_day_std_last_day-2": "float", "begin_session_time_of_day_std_last_day-3": "float", "end_session_time_of_day_std_last_day-3": "float", "begin_session_time_of_day_std_last_day-4": "float", "end_session_time_of_day_std_last_day-4": "float", "begin_session_time_of_day_std_last_day-5": "float", "end_session_time_of_day_std_last_day-5": "float", "begin_session_time_of_day_std_last_day-6": "float", "end_session_time_of_day_std_last_day-6": "float", "begin_session_time_of_day_std_last_day-7": "float", "end_session_time_of_day_std_last_day-7": "float", "begin_session_time_of_day_std_last_week-1": "float", "end_session_time_of_day_std_last_week-1": "float", "begin_session_time_of_day_std_last_week-2": "float", "end_session_time_of_day_std_last_week-2": "float", "begin_session_time_of_day_std_last_week-3": "long", "end_session_time_of_day_std_last_week-3": "long", "begin_session_time_of_day_std_last_month-1": "float", "end_session_time_of_day_std_last_month-1": "float", "begin_session_time_of_day_std_last_month-2": "long", "end_session_time_of_day_std_last_month-2": "long"}}, "inputs": [{"name": "default", "node_id": "91cc71d2-3b93-4631-9da6-7ab98dccae00", "output_name": "default"}], "outputs": [{"name": "default"}]}, {"node_id": "61b3de4f-5be4-4514-bdfc-e18c509ad5a7", "type": "TRANSFORM", "operator": "sagemaker.spark.custom_code_0.1", "parameters": {"operator": "Python (Pandas)", "pandas_parameters": {"code": "# Table is available as variable `df`\ncols = ['cohort_day_of_week',\n'begin_session_time_of_day_std_last_week-1',\n'player_lifetime',\n'begin_session_time_of_day_mean_last_day-1',\n'end_session_time_of_day_mean_last_week-1',\n'begin_session_time_of_day_mean_last_week-1',\n'cohort_id',\n'player_type',\n'begin_session_time_of_day_std_last_day-1',\n'end_session_time_of_day_mean_last_day-1',\n'begin_session_time_of_day_mean_last_day-2',\n'end_session_time_of_day_std_last_week-1',\n'end_session_time_of_day_std_last_day-1',\n'session_count',\n'end_session_time_of_day_mean_last_day-3',\n'begin_session_time_of_day_mean_last_day-3',\n'end_session_time_of_day_mean_last_day-2',\n'player_churn',\n'player_id']\n\ndf.drop(columns=[x for x in df.columns if x not in cols], inplace=True)\n\n"}, "pyspark_parameters": {}, "name": "bulk-drop-columns"}, "inputs": [{"name": "df", "node_id": "814cac1e-1370-414d-9f6e-879410954a0c", "output_name": "default"}], "outputs": [{"name": "default"}]}, {"node_id": "13c3a3bf-6168-4f41-aec7-1524feab96c3", "type": "TRANSFORM", "operator": "sagemaker.spark.manage_columns_0.1", "parameters": {"operator": "Drop column", "drop_column_parameters": {"column_to_drop": ["cohort_day_of_week"]}}, "inputs": [{"name": "df", "node_id": "61b3de4f-5be4-4514-bdfc-e18c509ad5a7", "output_name": "default"}], "outputs": [{"name": "default"}]}, {"node_id": "7d139b21-c0e0-415a-94df-bd950bc01d99", "type": "TRANSFORM", "operator": "sagemaker.spark.handle_missing_0.1", "parameters": {"operator": "Fill missing", "fill_missing_parameters": {"input_column": ["begin_session_time_of_day_std_last_day-1", "begin_session_time_of_day_std_last_week-1", "end_session_time_of_day_std_last_day-1", "end_session_time_of_day_std_last_week-1"], "fill_value": "0"}, "impute_parameters": {"column_type": "Numeric", "numeric_parameters": {"strategy": "Approximate Median"}}}, "inputs": [{"name": "df", "node_id": "13c3a3bf-6168-4f41-aec7-1524feab96c3", "output_name": "default"}], "outputs": [{"name": "default"}]}, {"node_id": "ad695f02-7da1-4918-87f9-b5c2554cf028", "type": "TRANSFORM", "operator": "sagemaker.spark.balance_data_0.1", "parameters": {"operator": "Random oversample", "ratio": 1, "smote_params": {"num_neighbors": 5}, "target_column": "player_churn"}, "inputs": [{"name": "df", "node_id": "7d139b21-c0e0-415a-94df-bd950bc01d99", "output_name": "default"}], "outputs": [{"name": "default"}]}, {"node_id": "72fcbaf3-eac6-41fd-a21e-160d3229d56a", "type": "TRANSFORM", "operator": "sagemaker.spark.encode_categorical_0.1", "parameters": {"operator": "One-hot encode", "one_hot_encode_parameters": {"input_column": ["player_type"], "invalid_handling_strategy": "Keep", "drop_last": false, "output_style": "Columns"}, "ordinal_encode_parameters": {"invalid_handling_strategy": "Replace with NaN"}}, "inputs": [{"name": "df", "node_id": "ad695f02-7da1-4918-87f9-b5c2554cf028", "output_name": "default"}], "outputs": [{"name": "default"}]}, {"node_id": "e0efa983-f30e-46bd-b7b5-825b74609d10", "type": "TRANSFORM", "operator": "sagemaker.spark.cast_single_data_type_0.1", "parameters": {"column": "player_churn", "original_data_type": "Boolean", "data_type": "long"}, "inputs": [{"name": "df", "node_id": "c13aa52a-8894-4b6a-87fd-a1373e66e8ae", "output_name": "default"}], "outputs": [{"name": "default"}]}, {"node_id": "c13aa52a-8894-4b6a-87fd-a1373e66e8ae", "type": "TRANSFORM", "operator": "sagemaker.spark.encode_categorical_0.1", "parameters": {"operator": "One-hot encode", "one_hot_encode_parameters": {"input_column": ["cohort_id"], "invalid_handling_strategy": "Keep", "drop_last": false, "output_style": "Columns"}, "ordinal_encode_parameters": {"invalid_handling_strategy": "Replace with NaN"}}, "inputs": [{"name": "df", "node_id": "72fcbaf3-eac6-41fd-a21e-160d3229d56a", "output_name": "default"}], "outputs": [{"name": "default"}]}, {"node_id": "d325712a-b99e-4649-a112-11d31290c9da", "type": "TRANSFORM", "operator": "sagemaker.spark.custom_code_0.1", "parameters": {"operator": "Python (Pandas)", "pandas_parameters": {"code": "from datetime import datetime, timezone\n\ndef generate_event_timestamp():\n    # naive datetime representing local time\n    naive_dt = datetime.now()\n    # take timezone into account\n    aware_dt = naive_dt.astimezone()\n    # time in UTC\n    utc_dt = aware_dt.astimezone(timezone.utc)\n    # transform to ISO-8601 format\n    event_time = utc_dt.isoformat(timespec='milliseconds')\n    event_time = event_time.replace('+00:00', 'Z')\n    return event_time\n\ndt = generate_event_timestamp()\ndf['event_time'] = dt"}, "pyspark_parameters": {}, "name": "create_event_timestamp"}, "inputs": [{"name": "df", "node_id": "e0efa983-f30e-46bd-b7b5-825b74609d10", "output_name": "default"}], "outputs": [{"name": "default"}]}, {"node_id": "557b6a84-02e8-40d0-8b76-561821fc9c79", "type": "TRANSFORM", "operator": "sagemaker.spark.manage_columns_0.1", "parameters": {"operator": "Rename column", "rename_column_parameters": {"columns_to_rename": [{"input_column": "begin_session_time_of_day_mean_last_day-1", "new_name": "begin_session_time_of_day_mean_last_day_1"}, {"input_column": "end_session_time_of_day_mean_last_week-1", "new_name": "end_session_time_of_day_mean_last_week_1"}, {"input_column": "begin_session_time_of_day_mean_last_week-1", "new_name": "begin_session_time_of_day_mean_last_week_1"}, {"input_column": "begin_session_time_of_day_std_last_day-1", "new_name": "begin_session_time_of_day_std_last_day_1"}, {"input_column": "end_session_time_of_day_mean_last_day-1", "new_name": "end_session_time_of_day_mean_last_day_1"}, {"input_column": "begin_session_time_of_day_mean_last_day-2", "new_name": "begin_session_time_of_day_mean_last_day_2"}, {"input_column": "end_session_time_of_day_std_last_week-1", "new_name": "end_session_time_of_day_std_last_week_1"}, {"input_column": "end_session_time_of_day_std_last_day-1", "new_name": "end_session_time_of_day_std_last_day_1"}, {"input_column": "end_session_time_of_day_mean_last_day-3", "new_name": "end_session_time_of_day_mean_last_day_3"}, {"input_column": "begin_session_time_of_day_mean_last_day-3", "new_name": "begin_session_time_of_day_mean_last_day_3"}, {"input_column": "end_session_time_of_day_mean_last_day-2", "new_name": "end_session_time_of_day_mean_last_day_2"}], "input_column": "begin_session_time_of_day_std_last_week-1", "new_name": "begin_session_time_of_day_std_last_week_1"}, "drop_column_parameters": {}}, "inputs": [{"name": "df", "node_id": "d325712a-b99e-4649-a112-11d31290c9da", "output_name": "default"}], "outputs": [{"name": "default"}]}, {"node_id": "5fa255c6-758a-475c-a696-aea88c374149", "type": "VISUALIZATION", "operator": "sagemaker.visualizations.data_insights_report_0.1", "parameters": {"name": "10-1-2024_5:01:45_PM", "insights_report_parameters": {"target_column": "player_churn", "problem_type": "Classification"}, "full_data": "false"}, "inputs": [{"name": "df", "node_id": "814cac1e-1370-414d-9f6e-879410954a0c", "output_name": "default"}], "outputs": [{"name": "default"}]}, {"node_id": "15a463b8-1cc7-44ae-ad36-b2bb71039022", "type": "VISUALIZATION", "operator": "sagemaker.visualizations.feature_correlation_0.1", "parameters": {"name": "10-1-2024_5:03:10_PM", "correlation_type": "linear", "insights_report_parameters": {}, "full_data": "false"}, "inputs": [{"name": "df", "node_id": "814cac1e-1370-414d-9f6e-879410954a0c", "output_name": "default"}], "outputs": [{"name": "default"}]}]}